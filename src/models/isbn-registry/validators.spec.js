import {assert} from 'chai';
import {isValidIsbnOrIsmnIdentifier} from './validators';

describe('Identifier model validator', () => {
  it('should evaluate valid ISBN/ISMN identifers as valid values', () => {
    const validIsbn13 = [
      '978-952-64-9442-5',
      '978-952-80-8757-1',
      '978-952-373-727-3',
      '978-952-81-8871-1',
      '978-952-68405-2-9',
      '978-952-80-7944-6',
      '978-952-7325-26-1',
      '978-952-390-049-3',
      '978-952-360-360-8',
      '978-951-97156-4-3',
      '978-952-7532-71-3',
      '978-952-369-731-7',
      '978-952-368-378-5',
      '978-952-64-6428-2',
      '978-952-7307-56-4',
      '978-952-399-912-1',
      '978-952-81-0070-6',
      '978-952-81-5055-8',
      '978-952-69075-1-2',
      '978-952-403-673-3',
      '978-952-371-690-2',
      '978-952-387-659-0',
      '978-952-81-8824-7',
      '978-952-81-4052-8',
      '978-952-376-254-1',
      '978-952-7312-66-7',
      '978-952-80-4614-1',
      '978-952-69267-3-5',
      '978-952-344-856-8',
      '978-952-407-526-8',
      '978-952-358-702-1',
      '978-952-81-8306-8',
      '978-952-398-181-2',
      '978-952-396-215-6',
      '978-952-7401-12-5',
      '978-952-352-023-3',
      '978-951-51-5057-8',
      '978-952-80-8576-8',
      '978-952-7384-18-3',
      '978-952-393-609-6',
      '978-952-80-9910-9',
      '978-952-381-439-4',
      '978-951-51-3438-7',
      '978-952-7438-10-7',
      '978-952-64-3016-4',
      '978-952-354-432-1',
      '978-952-7394-04-5',
      '978-952-345-398-2',
      '978-952-348-567-9',
      '978-952-81-3650-7',
      '978-952-389-495-2',
      '978-952-81-7651-0',
      '978-952-81-0015-7',
      '978-952-381-249-9',
      '978-952-7424-30-8',
      '978-952-64-2477-4',
      '978-952-7222-20-1',
      '978-952-64-1771-4',
      '978-952-80-6256-1',
      '978-952-7340-16-5',
      '978-952-7490-02-0',
      '978-952-401-372-7',
      '978-952-358-134-0',
      '978-952-394-823-5',
      '978-952-392-860-2',
      '978-952-409-132-9',
      '978-952-361-448-2',
      '978-952-93-8619-2',
      '978-952-81-9497-2',
      '978-952-344-584-0',
      '978-951-51-3366-3',
      '978-951-51-8078-0',
      '978-952-7266-91-5',
      '978-952-81-2169-5',
      '978-952-94-6827-0',
      '978-952-94-0612-8',
      '978-952-7263-27-3',
      '978-952-352-264-0',
      '978-952-353-311-0',
      '978-952-369-232-9',
      '978-952-81-8720-2',
      '978-952-7461-95-2',
      '978-951-51-6756-9',
      '978-952-380-896-6',
      '978-952-399-399-0',
      '978-952-347-758-2',
      '978-952-80-7876-0',
      '978-952-392-508-3',
      '978-952-353-946-4',
      '978-952-7426-36-4',
      '978-952-357-031-3',
      '978-952-376-105-6',
      '978-952-370-388-9',
      '978-952-7484-03-6',
      '978-952-68960-1-4',
      '978-952-64-9171-4',
      '978-952-7500-94-1',
      '978-952-64-4383-6',
      '978-952-80-5220-3',
      '978-952-7515-78-5',
      // ISMN
      '979-0-803367-89-9',
      '979-0-803366-60-1',
      '979-0-55014-999-1',
      '979-0-55015-378-3',
      '979-0-55015-363-9',
      '979-0-9001756-0-1',
      '979-0-55016-195-5',
      '979-0-55015-255-7',
      '979-0-55014-232-9',
      '979-0-803368-89-6',
      '979-0-55014-674-7',
      '979-0-55015-431-5',
      '979-0-55015-510-7',
      '979-0-55015-400-1',
      '979-0-55014-521-4',
      '979-0-55016-623-3',
      '979-0-55015-679-1',
      '979-0-9001726-9-3',
      '979-0-55016-028-6',
      '979-0-55015-503-9',
      '979-0-55016-336-2',
      '979-0-55015-045-4',
      '979-0-803365-55-0',
      '979-0-55015-756-9',
      '979-0-55014-124-7',
      '979-0-55016-294-5',
      '979-0-55015-245-8',
      '979-0-55001-489-3',
      '979-0-55016-356-0',
      '979-0-55015-813-9',
      '979-0-803369-11-4',
      '979-0-9001690-3-7',
      '979-0-803369-55-8',
      '979-0-55016-592-2',
      '979-0-55014-703-4',
      '979-0-55014-933-5',
      '979-0-55015-523-7',
      '979-0-9001731-7-1',
      '979-0-55001-408-4',
      '979-0-55001-487-9',
      '979-0-55016-309-6',
      '979-0-9001743-1-4',
      '979-0-55015-707-1',
      '979-0-803365-64-2',
      '979-0-55015-429-2',
      '979-0-9001723-9-6',
      '979-0-55014-859-8',
      '979-0-55015-913-6',
      '979-0-9001752-5-0',
      '979-0-55015-715-6',
      '979-0-55016-587-8',
      '979-0-9001718-8-7',
      '979-0-55014-168-1',
      '979-0-55015-487-2',
      '979-0-55014-638-9',
      '979-0-55016-911-1',
      '979-0-55016-211-2',
      '979-0-803366-45-8',
      '979-0-55016-878-7',
      '979-0-55016-088-0',
      '979-0-803367-33-2',
      '979-0-55014-264-0',
      '979-0-55015-545-9',
      '979-0-9001735-1-5',
      '979-0-55014-780-5',
      '979-0-803367-35-6',
      '979-0-803365-22-2',
      '979-0-9001714-2-9',
      '979-0-803364-20-1',
      '979-0-55014-068-4',
      '979-0-55015-970-9',
      '979-0-55015-989-1',
      '979-0-55001-408-4',
      '979-0-803365-93-2',
      '979-0-55014-813-0',
      '979-0-55015-822-1',
      '979-0-55016-973-9',
      '979-0-55016-318-8',
      '979-0-9001679-3-4',
      '979-0-55014-164-3',
      '979-0-9001723-9-6',
      '979-0-55014-961-8',
      '979-0-55016-854-1',
      '979-0-803364-06-5',
      '979-0-55014-937-3',
      '979-0-55016-498-7',
      '979-0-55015-251-9',
      '979-0-55016-863-3',
      '979-0-55014-106-3',
      '979-0-55016-768-1',
      '979-0-9001757-0-0',
      '979-0-55015-104-8',
      '979-0-55015-710-1',
      '979-0-55016-126-9',
      '979-0-55016-094-1',
      '979-0-55016-714-8',
      '979-0-55016-693-6',
      '979-0-55016-392-8',
      '979-0-9001752-1-2',
      '979-0-55014-776-8'
    ];

    validIsbn13.forEach(v => {
      assert.doesNotThrow(() => isValidIsbnOrIsmnIdentifier(v));
    });
  });

  it('should throw error if value is not valid', () => {
    const invalidInputs = [
      '978-92-95055-12-4', // Valid ISBN-13, but not with Finnish language code and thus should be invalid
      '0-8436-1072-7', // ISBN-10 with dash is not valid (calculator only accepts values without dashes),
      '0843610727', // ISBN-10 without dashes is not valid
      9789295055124, // Valid ISBN-13 without dashes but as integer
      {'9789295055124': ''}, // Valid ISBN-13 without dashes but as object
      ['9789295055124'], // Valid ISBN-13 without dashes but as array
      '978-92-95055-12-1', // Invalid check digits ISBN
      '978-92-95055-20-2',
      '978-952-64-9442-3',
      '978-952-80-8757-4',
      '978-952-373-727-5',
      '978-952-81-8871-6',
      '978-952-68405-2-7',
      '978-952-80-7944-8',
      '978-952-7325-26-9',
      '978-952-390-049-0',
      '979-0-803367-89-0', // Invalid check digits ISMN
      '979-0-803366-60-9',
      '979-0-55014-999-8',
      '979-0-55015-378-7',
      '979-0-55015-363-6',
      '979-0-9001756-0-5',
      '979-0-55016-195-4',
      '979-0-55015-255-3',
      '979-0-55014-232-2',
      '979-0-803368-89-1',
      '979-0-9001752-1-0'
    ];

    // Note: here dashes are not removed from string values as opposed to tests which calculate check digit
    invalidInputs.forEach(v => {
      assert.throws(() => isValidIsbnOrIsmnIdentifier(v), Error);
    });
  });

});
